# **MSA Example**

## **시작하기 전에...**
- **크리스 리처드슨**의 **[마이크로서비스 패턴](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=228694618)** 책을 읽고 많은 유용한 지식을 얻을 수 있었으며
- **jfeng45**님의 **[github 레포지토리](https://github.com/jfeng45/servicetmpl)** 와 **[medium 블로그](https://medium.com/@jfeng45/go-micro-service-with-clean-architecture-application-layout-e6216dbb835a)** 에서 많은 도움을 받았습니다.

<br>

---
## **프로젝트 계기**
**Building Microservices with Go** 책을 읽고 3강을 정리한 후에 **go언어에 대한 익숙함**과 **MSA에 대한 기본적인 이론**은 익혔다고 생각하였습니다.   
하지만 막상 MSA 기반의 개인 프로젝트를 진행하려고 하니 **전자인 익숙함은 익혔을지라도 후자인 이론은 너무 허실하고 부족**하여 이 프로젝트를 어떻게 시작해야할지 감이 전혀 안오고 **너무 막막했습니다.**   
따라서 제가 결정한게 위에서 말씀드린 **마이크로서비스 패턴**이라는 책을 사서, 실제 MSA 서비스를 위한 **탄탄한 기본 지식뿐만 아니라, 프로젝트에 도입할 수 있는 용기**를 쌓는 것이였습니다.  
그렇게 해서 만들게된 것이 **4강인 MSA Example**으로, 생각했던 시간이 코드를 짰던 시간보다 **10배는 많을 정도**로 대충 짠것이 절대 아닌, 온갖 스트레스와 프로젝트 구조에 대한 막막하고 두려운 감정을 **오직 해내고 싶다는 마음 하나로 이겨내면서 만든 것**임을 꼭 알아주셨으면 합니다.  
그러면 이제부터 제 프로젝트에 도입된 **프로젝트 구조와 공통 패턴들**을 알려드리겠습나다. 

<br>

---
## 

<br>

---
## **프로젝트 구조**
<img src="./Project.png" width="270" height="300">

-  ### **cmd**
    - 모든 마이크로서비스 **프로그램들의 시작점**으로, **main.go, server, docker-compose.yml, DockerFile**로 구성되어있습니다.
    - **main.go** - 엔드포인트를 만드는 **main 함수**로, 각각의 계층에 **의존성을 주입**하여 **서비스를 실행**시킵니다.
    - **server** - main.go 파일을 **배포 환경**인 리눅스 환경에서 실행시키기 위해 **크로스 컴파일**하여 만든 바이너리 **실행 파일**입니다.
    - **DockerFile** - 배포환경에서 서버를 실행할 Docker Container를 만들기 위해 **Docker image를 생성하는 DockerFile**입니다.
    - **docker-compose.yml** - DockerFile로 만든 이미지를 이용하여 **쉽게 컨테이너를 만들수 있게 해주는** yml 파일입니다.

- ### **dataservice**
    - 오직 **model layer에만 의존**하여 도메인 계층의 데이터를 검색하고 수정하는 **persistance layer**입니다.
    - **db_service_interface.go** - go언어로 구현된 마이크로서비스에서 제공하는 모든 **data service를 위한 인터페이스**가 있습니다. 다른 패키지들은 해당 **인터페이스에만 의존**해야 하며, DB CRUD의 세부 구현 사항에 대해 알 필요가 없습니다.
    - **테이블 이름_data_service.go** - 위에서 말씀드린 인터페이스들을 구현하는 객체들로, 의존성으론 DB 연결에 대한 객체 하나만 포함하고 있습니다. 참고로 MSA 특성 상, 특정 테이블에 접근할 수 있는 서비스는 정해져 있으므로 data service도 마찬가지로 알맞은 서비스에서 사용해야 합니다.

- ### **entities**
    - entities는 사용자가 호출하는 서버-클라이언트 사이의 http 통신을 위해 **json과 객체 사이에 인코딩 및 디코딩을 도와주는 객체**들을 모와놓은 폴더입니다. 참고로 **유효성 타입 검사**를 진행하기 위해서 태그를 이용합니다.